{% extends 'FiscaliteGestionFiscaliteBundle::layout.html.twig' %}

{% block contenu %}
<div class="container-fluid page-container">
    <div class="row">
                    <div class="sidebar content-tab col-sm-6 col-md-3 col-lg-3">
{{ form_start(form, {'attr': {'class': 'form-horizontal'} }) }}
{{ form_errors(form) }}
                                <div class="form-group"> 
                                {# Génération du label. #}
                                {{ form_label(form.anneetaxation, "Année de taxation : ",{ 'label_attr': { 'class': 'col-sm-6'} }) }}
                                <div class="col-sm-6">
                                {# Affichage des erreurs pour ce champ précis. #}
                                {{ form_errors(form.anneetaxation,{ 'attr': { 'class': 'col-sm-12' } }) }}
                                {# Génération de l'input. #}
                                {{ form_widget(form.anneetaxation,{ 'attr': { 'class': 'col-sm-12' } }) }} 
                                </div>
                            </div> 
                            <div class="form-group">
                                {# Génération du label. #}
                                {{ form_label(form.titreetdesignation, "Titre et Désignation : ",{ 'label_attr': { 'class': 'col-sm-6'} }) }}
                                <div class="col-sm-6">
                                {# Affichage des erreurs pour ce champ précis. #}
                                {{ form_errors(form.titreetdesignation,{ 'attr': { 'class': 'col-sm-12' } }) }}
                                {# Génération de l'input. #}
                                {{ form_widget(form.titreetdesignation, {'attr': {'class': 'form-control','data-url': path('fiscalite_ajaxTitreEtDesignation')} }) }}
                                </div>
                            </div>
                            <div class="form-group">        
                                {# Génération du label. #}
                                {{ form_label(form.sommeapayermin, "Somme à payer min : ",{ 'label_attr': { 'class': 'col-sm-6'} }) }}
                                <div class="col-sm-6">
                                {# Affichage des erreurs pour ce champ précis. #}
                                {{ form_errors(form.sommeapayermin,{ 'attr': { 'class': 'col-sm-12' } }) }}
                                {# Génération de l'input. #}
                                {{ form_widget(form.sommeapayermin,{ 'attr': { 'class': 'col-sm-12' } }) }} 
                                </div>
                            </div>
                            <div class="form-group">          
                                {# Génération du label. #}
                                {{ form_label(form.sommeapayermax, "Somme à payer max : ",{ 'label_attr': { 'class': 'col-sm-6'} }) }}
                                <div class="col-sm-6">
                                {# Affichage des erreurs pour ce champ précis. #}
                                {{ form_errors(form.sommeapayermax,{ 'attr': { 'class': 'col-sm-12' } }) }}
                                {# Génération de l'input. #}
                                {{ form_widget(form.sommeapayermax,{ 'attr': { 'class': 'col-sm-12' } }) }} 
                                </div>
                            </div>
<div class="col-sm-offset-1 col-sm-2">
{{ form_end(form , {'attr': {'class': 'btn btn-default'} }) }}
</div> 
                        </div>
                            <div class="content-tab col-sm-12 col-md-9  col-lg-8">
                                {% for TFarticleCommuneIFP in paginationIFP %}
                                    <div class="row">
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <h5>Libellé de la commune : {{TFarticleCommuneIFP.getLibCommunne()}}</h5>
                                        </div>
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <h5>Libellé intercommunalité à laquelle adhère la commune : {{TFarticleCommuneIFP.getLibelleICAdhC()}}</h5>
                                        </div>

                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Taux bâti/Commune : {{TFarticleCommuneIFP.getTXBC()}}% </p>
                                        </div>  
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Taux non bâti/Commune : {{TFarticleCommuneIFP.getTXNC()}}% </p>
                                        </div> 
                                    </div>
                                {% endfor %}
                                {% for TFarticleCommuneSRA2 in paginationSRA2 %}
                                    <div class="row">
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Total base bâti/Commune : {{TFarticleCommuneSRA2.getTotBBC()|number_format(0,'',' ')}}€ </p>
                                        </div>  
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Total cotisation bâti/Commune : {{TFarticleCommuneSRA2.getTotCBC()|number_format(0,'',' ')}}€ </p>
                                        </div> 
                                    </div>
                                {% endfor %}   
                                {% for TFarticleCommuneSRA3 in paginationSRA3 %}
                                    <div class="row">
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Total base non bâti/Commune : {{TFarticleCommuneSRA3.getTotBNC()|number_format(0,'',' ')}}€ </p>
                                        </div>  
                                        <div class="col-sm-6 col-md-6  col-lg-6">
                                            <p>Total cotisation non bâti/Commune : {{TFarticleCommuneSRA3.getTotCNC()|number_format(0,'',' ')}}€ </p>
                                        </div> 
                                    </div>
                                {% endfor %}    
                                </div>
                    </div>
                    <div class="row">
                      <div class="content-tab col-sm-6 col-md-3  col-lg-3">                   
                         <p>TF </p>
                      </div>
                              <div class="content-tab col-sm-12 col-md-12 col-lg-8">
                                        <div> <h5>{{ "Résultat : "~ paginationC1.getTotalItemCount ~" article(s) trouvé(s)."}}</h5></div>
                                        <table class="table table-striped table-hover ">
                                            <thead>
                                                <tr>
                                                    <th class="text-center">Année</th><th  class="text-center">{{ knp_pagination_sortable(paginationC1, 'Titre et Désignation', 'a.titreEtDesignation') }}</th>
                                                    <th class="text-center">Adresse</th><th class="text-center">Somme à payer</th>
                                                </tr>
                                            </thead>
                                            <tbody> {% for article in paginationC1 %}

                                                <tr>
                                                    <td class="text-center">{{article.getFichier().getAnneeTaxation()}}</td>
                                                    <td class="text-center"><a href="{{ path('articleTF',{'id': article.getNumerosequentiel()}) }}">{{article.getTitreEtDesignation() ~" "~ article.getSuiteDesignation()}}</a></td>
                                                    <td class="text-center">
                                                    {% if article.getComplementAdresse() == NULL and article.getLigneVoie() == NULL and article.getLigneCodePostalEtCommune() == NULL %}
                                                        {{"Non renseigné"}}
                                                    {%else%} 
                                                        {{article.getComplementAdresse() ~" "~article.getLigneVoie()~ " "~ article.getLigneCodePostalEtCommune() }}
                                                    {% endif %}
                                                        </td>
                                                        <td class="text-center">{% if article.getSommeAPayer() == NULL %}
                                                                {{"0 €"}}
                                                            {%else%} 
                                                                {{article.getSommeAPayer()|number_format(0, ',', ' ') ~ '€'}}
                                                            {% endif %}
                                                        </td>
                                                       
                                                    </tr>
                                                    {% endfor %}   
                                                    </tbody>
                                                </table>
                                                <div class="navigation pagination">
                                                    {{ knp_pagination_render(paginationC1,null, {}, {'alignment': 'center'}) }}
                                                    </div>
                                                </div>   
                            
                    </div>
 </div>
 <script>
    $(document).ready(function() {
    var attr = $('#fiscalite_gestionfiscalitebundle_recherchearticletftype_titreetdesignation').attr('data-url');
    $("#fiscalite_gestionfiscalitebundle_recherchearticletftype_titreetdesignation").autocomplete({
        minLength: 2,
        source: attr
    });
});
</script>          
       
{% endblock %}
{% block footer %}
{{ parent() }}
{% endblock %}